<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="karyotapR">
<title>GMMs for Copy Number Calling • karyotapR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GMMs for Copy Number Calling">
<meta property="og:description" content="karyotapR">
<meta property="og:image" content="http://joeymays.xyz/karyotapR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">karyotapR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/karyotapR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GMMs-for-Copy-Number-Calling.html">GMMs for Copy Number Calling</a>
    <a class="dropdown-item" href="../articles/barcoding.html">Barcoding and gRNA Probes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/joeymays/karyotapR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>GMMs for Copy Number Calling</h1>
            
            <h4 data-toc-skip class="date">Compiled on September 16,
2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/joeymays/karyotapR/blob/HEAD/vignettes/articles/GMMs-for-Copy-Number-Calling.Rmd" class="external-link"><code>vignettes/articles/GMMs-for-Copy-Number-Calling.Rmd</code></a></small>
      <div class="d-none name"><code>GMMs-for-Copy-Number-Calling.Rmd</code></div>
    </div>

    
    
<p>The objective of using Gaussian Mixture Models (GMMs) is to assign
discrete copy number values to each chromosome in each cell in a
Tapestri experiment in a probabilistic manner, such that a “soft”
classification is applied, but each cell-chromosome unit has an
associated posterior probability of belonging to each copy number bin.
This allows us to appreciate how a cell-chromosome can be assigned a
copy number of 3 (for which it has the highest probability of belonging)
but could actually have a copy number of 2 or 4, and falls within the
distribution of possible copy number scores for copy number = 2 or
4.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joeymays/karyotapR" class="external-link">karyotapR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus" class="external-link">fitdistrplus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/ggdist/" class="external-link">ggdist</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span>  <span class="co"># seed set for example reproducibility</span></span></code></pre></div>
<p>The goal is to generate values that could be expected to have come
from diploid cells (in this case, RPE1 cells). The first step is to
model the counts from each probe as a Weibull distribution.</p>
<p>Take control (near-diploid) cells, normalize counts.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rpe1.bc</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">cellmix</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cluster</span> <span class="op">==</span> <span class="st">"RPE1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">cell.barcode</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raw.data.rpe1</span> <span class="op">&lt;-</span> <span class="fu">assay</span><span class="op">(</span><span class="va">cellmix</span>, <span class="st">"counts"</span><span class="op">)</span><span class="op">[</span>, <span class="va">rpe1.bc</span><span class="op">]</span></span>
<span><span class="va">norm.data.rpe1</span> <span class="op">&lt;-</span> <span class="fu">karyotapR</span><span class="fu">:::</span><span class="fu">.MBNormCounts</span><span class="op">(</span><span class="va">raw.data.rpe1</span><span class="op">)</span></span>
<span><span class="va">norm.data.rpe1</span><span class="op">[</span><span class="va">norm.data.rpe1</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>  <span class="co">#set 0 to 0.01 </span></span>
<span><span class="va">norm.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">norm.data.rpe1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Fit weibull distributions to each probe and store distribution
parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wfit.ft</span> <span class="op">&lt;-</span> <span class="va">norm.data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/fitdist.html" class="external-link">fitdist</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.x</span>, distr <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wfit</span> <span class="op">&lt;-</span> <span class="va">wfit.ft</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="va">.x</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></span></code></pre></div>
<p>Diagnostic plots indicate that weibull distribution is a good fit for
representative sample of probes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probe.sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">probe.sample</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/graphcomp.html" class="external-link">denscomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">wfit.ft</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">.x</span>,</span>
<span>    plotstyle <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/fit%20plots-1.png" width="100%" height="60%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">probe.sample</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/graphcomp.html" class="external-link">qqcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">wfit.ft</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">.x</span>,</span>
<span>    plotstyle <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/fit%20plots-2.png" width="100%" height="60%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu">plot_grid</span><span class="op">(</span>plotlist <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">probe.sample</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/graphcomp.html" class="external-link">cdfcomp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">wfit.ft</span><span class="op">[[</span><span class="va">.x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, main <span class="op">=</span> <span class="va">.x</span>,</span>
<span>    plotstyle <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/fit%20plots-3.png" width="100%" height="60%"></p>
<p>The fitted parameters correspond to count values expected to be
measured by probes for samples that are have copy number = 2 (diploid).
The exceptions are probes targeted to chr10q which have copy number =
3.</p>
<p>We then scale the <code>scale</code> parameters of the distributions
so that they correspond to copy number = 1, 2, 3, 4, 5, and 6. For
probes targeting diploid chromosomes, we multiply <code>scale</code> by
0.5, 1.0, 1.5, 2.0, 2.5, and 3.0. For probes with copy number = 3, we
multiply <code>scale</code> by 0.33, 0.67, 1.0, 1.33, 1.67, and 2.0.</p>
<p>Now, each probe has 6 sets of parameters, each corresponding to a
copy number level between 1-6. For each probe, we generate 500 values
according to the distribution parameters, and repeat for each copy
number level. This effectively creates 6 matrices, each containing 500
simulated cells with a count value for each probe.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cellmix.rpe1 <span class="ot">&lt;-</span> cellmix[, rpe1.bc]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>control.cn <span class="ot">&lt;-</span> <span class="fu">generateControlCopyNumberTemplate</span>(cellmix.rpe1, <span class="at">copy.number =</span> <span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>control.cn[<span class="st">"chr10q"</span>, <span class="st">"copy.number"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>simulated.cells <span class="ot">&lt;-</span> karyotapR<span class="sc">:::</span><span class="fu">.generateSimulatedCNVCells</span>(cellmix.rpe1, <span class="at">control.copy.number =</span> control.cn,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.simulated.cells =</span> <span class="dv">500</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>ℹ Generating probe values <span class="cf">for</span> <span class="dv">500</span> simulated cells...</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>✔ Generating probe values <span class="cf">for</span> <span class="dv">500</span> simulated cells... [<span class="fl">2.7</span>s]</span></code></pre></div>
<p>The number of simulated cells is 500 cells per copy number * number
of copy number levels = 500 x 6 = 3000</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">simulated.cells</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  317 3000</span></span>
<span><span class="fu"><a href="../reference/corner.html">corner</a></span><span class="op">(</span><span class="va">simulated.cells</span><span class="op">)</span></span>
<span><span class="co">#&gt;            sim_cn1_1 sim_cn1_2 sim_cn1_3 sim_cn1_4 sim_cn1_5</span></span>
<span><span class="co">#&gt; AMPL158802 1.2444675 0.2536109 0.6356453 0.7600854 0.5841585</span></span>
<span><span class="co">#&gt; AMPL146998 1.5996021 1.0701389 0.5079203 1.4144141 0.7445332</span></span>
<span><span class="co">#&gt; AMPL158817 0.2762755 0.7195697 0.9380570 0.2673831 0.8031990</span></span>
<span><span class="co">#&gt; AMPL158827 1.3242461 0.8277687 0.6342295 0.4824822 1.4058630</span></span>
<span><span class="co">#&gt; AMPL147006 0.7877675 0.8507313 0.5864658 0.9298129 1.3664182</span></span></code></pre></div>
<p>The simulated probe values are then smoothed such that each
cell-chromosome unit has one smoothed copy number value, as we would do
for a normal Tapestri experiment analysis. This occurs both at the level
of whole chromosome and chromosome arms separately.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated.tapestri.experiment</span> <span class="op">&lt;-</span> <span class="fu">karyotapR</span><span class="fu">:::</span><span class="fu">.smoothSimulatedCells</span><span class="op">(</span>normalized.counts <span class="op">=</span> <span class="va">simulated.cells</span>,</span>
<span>    probe.metadata <span class="op">=</span> <span class="fu">rowData</span><span class="op">(</span><span class="va">cellmix</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Visualizing the smoothed copy number values for the simulated cells
confirms we have 6 groups of cells, each representing one copy number
level across all chromosomes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/assayHeatmap.html">assayHeatmap</a></span><span class="op">(</span><span class="va">simulated.tapestri.experiment</span>, alt.exp <span class="op">=</span> <span class="st">"smoothedCopyNumberByChr"</span>,</span>
<span>    assay <span class="op">=</span> <span class="st">"smoothedCopyNumber"</span>, split.col.by <span class="op">=</span> <span class="st">"feature.id"</span>, split.row.by <span class="op">=</span> <span class="st">"cn.sim.class"</span>,</span>
<span>    annotate.row.by <span class="op">=</span> <span class="st">"cn.sim.class"</span>, color.preset <span class="op">=</span> <span class="st">"copy.number"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/heatmap%201-1.png" width="100%" height="60%"></p>
<p>For a given chromosome, the simulated values are roughly normally
distributed, representing the distribution of the expected copy number
values that would be measured by our probe panel for cells with true
copy number values of 1-6. Notice that for copy numbers &gt; 2, the
spread of the distributions are such that a cell with true copy number =
4, for example, could have a smoothed copy number value between ~2.5 and
~5.5, making rounding the value to an integer a problematic way to
assign copy number values.</p>
<p>The overlaped regions become larger with fewer probes, as in Chr 19,
making the assignment of copy number values less straightforward.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTidyData.html">getTidyData</a></span><span class="op">(</span><span class="va">simulated.tapestri.experiment</span>, alt.exp <span class="op">=</span> <span class="st">"smoothedCopyNumberByChr"</span>,</span>
<span>    assay <span class="op">=</span> <span class="st">"smoothedCopyNumber"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy.data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature.id</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smoothedCopyNumber</span>, fill <span class="op">=</span> <span class="va">cn.sim.class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Chromosome 1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/GMM%20chr1chr19-1.png" width="100%" height="60%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">tidy.data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">feature.id</span> <span class="op">==</span> <span class="fl">19</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smoothedCopyNumber</span>, fill <span class="op">=</span> <span class="va">cn.sim.class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Chromosome 19"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/GMM%20chr1chr19-2.png" width="100%" height="60%"></p>
<p>To build the Gaussian Mixture Model (GMM) for assigning copy number
labels to each cell-chromosome unit, we first fit Gaussian (normal)
distributions to the smoothed copy number values of each chromosome and
copy number level. Each chromosome and copy number level is now
represented by the mean and standard deviation parameters of a normal
distribution.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cn.model.params.chr</span> <span class="op">&lt;-</span> <span class="fu">karyotapR</span><span class="fu">:::</span><span class="fu">.fitGaussianDistributions</span><span class="op">(</span>simulated.tapestri.experiment <span class="op">=</span> <span class="va">simulated.tapestri.experiment</span>,</span>
<span>    chromosome.scope <span class="op">=</span> <span class="st">"chr"</span><span class="op">)</span></span>
<span><span class="va">cn.model.params.chr</span></span>
<span><span class="co">#&gt; # A tibble: 138 × 4</span></span>
<span><span class="co">#&gt;    feature.id cn.sim.class  mean    sd</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;      &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 1          sim_cn1       1.01 0.147</span></span>
<span><span class="co">#&gt;  2 1          sim_cn2       2.01 0.301</span></span>
<span><span class="co">#&gt;  3 1          sim_cn3       3.01 0.453</span></span>
<span><span class="co">#&gt;  4 1          sim_cn4       4.07 0.590</span></span>
<span><span class="co">#&gt;  5 1          sim_cn5       5.03 0.762</span></span>
<span><span class="co">#&gt;  6 1          sim_cn6       6.01 0.938</span></span>
<span><span class="co">#&gt;  7 2          sim_cn1       1.02 0.134</span></span>
<span><span class="co">#&gt;  8 2          sim_cn2       2.01 0.272</span></span>
<span><span class="co">#&gt;  9 2          sim_cn3       3.03 0.404</span></span>
<span><span class="co">#&gt; 10 2          sim_cn4       4.04 0.575</span></span>
<span><span class="co">#&gt; # ℹ 128 more rows</span></span></code></pre></div>
<p>Based on the normal distribution parameters, we create a Gaussian
Mixture Model (GMM) for each chromosome. This model covers the expected
distribution of smoothed copy number values for the chromosome, for
cells with 1-6 copies of the chromosome.</p>
<p>Because the components of the model overlap, assigning an integer
copy number value based on <code>smoothedCopyNumber</code> is not
straight-forward. For instance, a cell with a
<code>smoothedCopyNumber</code> value of 3.5 falls under the
distributions for copy number = 3, 4, and 5! To make the call, we
calculate the probability that a cell belongs to a copy number component
using Bayes Rule, assuming equal priors for 5 components. Here we are
evaluating copy number using a model with components representing copy
number = 1, 2, 3, 4, or 5.</p>
<p>The cell is assigned the copy number value for whichever posterior
probability is the highest.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cn.model.table.chr</span> <span class="op">&lt;-</span> <span class="fu">karyotapR</span><span class="fu">:::</span><span class="fu">.calcClassPosteriors</span><span class="op">(</span>TapestriExperiment <span class="op">=</span> <span class="va">cellmix</span>,</span>
<span>    cn.model.params <span class="op">=</span> <span class="va">cn.model.params.chr</span>, model.components <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, model.priors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>        <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, chromosome.scope <span class="op">=</span> <span class="st">"chr"</span><span class="op">)</span></span>
<span><span class="va">cn.model.table.chr</span> <span class="op">&lt;-</span> <span class="fu">karyotapR</span><span class="fu">:::</span><span class="fu">.callCopyNumberClasses</span><span class="op">(</span><span class="va">cn.model.table.chr</span><span class="op">)</span></span></code></pre></div>
<p>Here are the posterior probabilities for 10 cells for chromosome 1.
<code>sim_cn1</code>, <code>sim_cn2</code> etc. are the posterior
probabilities that the cell-chromosome unit belongs to each of the five
copy number components. <code>cn.class</code> represents the copy number
component for which the posterior probability was the highest.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cn.model.table.chr</span><span class="op">$</span><span class="va">cn.class</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, <span class="va">cn.model.table.chr</span><span class="op">$</span><span class="va">cn.probability</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>    <span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;            cell.barcode cn.class      sim_cn1   sim_cn2    sim_cn3      sim_cn4      sim_cn5</span></span>
<span><span class="co">#&gt; 1  AACAACCTAATAGTGGTT-1        2 7.877948e-19 0.6590784 0.32893811 0.0108041847 1.179297e-03</span></span>
<span><span class="co">#&gt; 2  AACAACCTAGTCCTAGTT-1        2 8.391042e-06 0.9796430 0.01996909 0.0003265456 5.296366e-05</span></span>
<span><span class="co">#&gt; 3  AACAACCTATGGACGAGA-1        2 2.678006e-17 0.7440963 0.24771740 0.0073667275 8.196144e-04</span></span>
<span><span class="co">#&gt; 4  AACAACTGGGACATAACG-1        3 8.631727e-28 0.1485616 0.79809819 0.0482601422 5.080044e-03</span></span>
<span><span class="co">#&gt; 5  AACAACTGGGGAACCTAG-1        2 1.329662e-02 0.9754359 0.01106268 0.0001695145 3.525542e-05</span></span>
<span><span class="co">#&gt; 6  AACAATGCAATTCACCTC-1        2 2.359324e-21 0.4957158 0.48349360 0.0187845433 2.006025e-03</span></span>
<span><span class="co">#&gt; 7  AACACACTCATACTTGCT-1        2 6.250566e-05 0.9827981 0.01682516 0.0002682120 4.604722e-05</span></span>
<span><span class="co">#&gt; 8  AACAGATCGCCATAGCCA-1        2 8.669628e-05 0.9832327 0.01637546 0.0002600836 4.509651e-05</span></span>
<span><span class="co">#&gt; 9  AACAGCAGTCATTGACAA-1        2 5.210720e-16 0.8035001 0.19068064 0.0052260780 5.932289e-04</span></span>
<span><span class="co">#&gt; 10 AACAGCAGTTCCGATCTG-1        2 1.983447e-08 0.9644437 0.03483694 0.0006302092 8.908706e-05</span></span></code></pre></div>
<p>To demonstrate this another way, let’s look at a visual. The “bins”
for assigning a smoothed copy number value to a discrete copy number
integer can be determined by calculating the boundaries between the copy
number components’ probability density functions (PDF). Smoothed copy
number values (x-axis) will be assigned to the copy number bin for which
it has the highest posterior probability of belonging, which is the bin
whose boundaries the value falls within.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getGMMBoundaries.html">getGMMBoundaries</a></span><span class="op">(</span><span class="va">cellmix</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 23 × 6</span></span>
<span><span class="co">#&gt;    feature.id boundary.1 boundary.2 boundary.3 boundary.4 boundary.5</span></span>
<span><span class="co">#&gt;    &lt;fct&gt;           &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 1                1.36       2.46       3.51       4.51       5.57</span></span>
<span><span class="co">#&gt;  2 2                1.37       2.47       3.54       4.55       5.6 </span></span>
<span><span class="co">#&gt;  3 3                1.39       2.47       3.57       4.64       5.69</span></span>
<span><span class="co">#&gt;  4 4                1.41       2.49       3.58       4.65       5.74</span></span>
<span><span class="co">#&gt;  5 5                1.41       2.49       3.56       4.64       5.7 </span></span>
<span><span class="co">#&gt;  6 6                1.38       2.45       3.49       4.57       5.58</span></span>
<span><span class="co">#&gt;  7 7                1.39       2.48       3.53       4.58       5.63</span></span>
<span><span class="co">#&gt;  8 8                1.39       2.46       3.5        4.55       5.59</span></span>
<span><span class="co">#&gt;  9 9                1.38       2.5        3.54       4.61       5.71</span></span>
<span><span class="co">#&gt; 10 10               1.38       2.48       3.57       4.61       5.65</span></span>
<span><span class="co">#&gt; # ℹ 13 more rows</span></span>
<span><span class="fu"><a href="../reference/plotCopyNumberGMM.html">plotCopyNumberGMM</a></span><span class="op">(</span><span class="va">cellmix</span>, feature.id <span class="op">=</span> <span class="fl">1</span>, draw.boundaries <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/GMM%20boundaries-1.png" width="100%" height="60%"></p>
<p>To get a sense of how accurate the model is, we can calculate the
theoretical true positive rate for each component, i.e. the proportion
of the component for which it’s values fall within it’s boundaries. Put
another way, we want to determine the proportion of cells with true copy
number = 2 that would fall within the boundaries for copy number = 2, so
that they would be assigned copy number = 2.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCopyNumberGMM.html">plotCopyNumberGMM</a></span><span class="op">(</span><span class="va">cellmix</span>, feature.id <span class="op">=</span> <span class="fl">1</span>, draw.boundaries <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">chr1.data</span> <span class="op">&lt;-</span> <span class="va">chr1</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cn</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr1.data.lines</span> <span class="op">&lt;-</span> <span class="va">chr1</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">y.max</span> <span class="op">&lt;-</span> <span class="va">chr1.data.lines</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cn</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr1.data</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/geom_slab.html" class="external-link">geom_slab</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">chr1.data</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, thickness <span class="op">=</span> <span class="va">y</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">1.37</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">2.46</span><span class="op">)</span>, scale <span class="op">=</span> <span class="va">y.max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Chromosome 1"</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>, x <span class="op">=</span> <span class="st">"Copy Number"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">chr1.data.lines</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">cn</span><span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.5</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.37</span>, <span class="fl">2.46</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey75"</span>, <span class="st">"lightgreen"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"True Positive"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Copy Number"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/GMM%20plot-1.png" width="100%" height="60%"></p>
<p>To calculate the theoretical true positive rate for copy number = 2,
we calculate the proportion of the area under the curve of the grey
sections and subtract them from 1 to get the proportion of the area in
the green section, 0.93. We would expect 93% of cells with true copy
number = 2 to be labeled as having copy number = 2. The remaining 7%
would be false negatives with incorrect labels.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lower.p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">1.37</span>, <span class="fl">2.0551875</span>, <span class="fl">0.2845473</span>, lower.tail <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">upper.p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">2.46</span>, <span class="fl">2.0551875</span>, <span class="fl">0.2845473</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">lower.p</span> <span class="op">+</span> <span class="va">upper.p</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.9145616</span></span></code></pre></div>
<p>If we repeat for chromosome 19, we can see that the spread of the
distribution is greater. The true positive rate is 65.8%, so the
sensitivity for detecting cells with copy number = 2 for chromosome 19
is significantly less than for chromosome 2.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chr19</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotCopyNumberGMM.html">plotCopyNumberGMM</a></span><span class="op">(</span><span class="va">cellmix</span>, feature.id <span class="op">=</span> <span class="fl">19</span>, draw.boundaries <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">chr19.data</span> <span class="op">&lt;-</span> <span class="va">chr19</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cn</span> <span class="op">==</span> <span class="fl">2</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chr19.data.lines</span> <span class="op">&lt;-</span> <span class="va">chr19</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cn</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">y.max</span> <span class="op">&lt;-</span> <span class="va">chr19.data.lines</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cn</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chr19.data</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggdist</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/ggdist/reference/geom_slab.html" class="external-link">geom_slab</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">chr19.data</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, thickness <span class="op">=</span> <span class="va">y</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">1.56</span> <span class="op">&amp;</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="fl">2.81</span><span class="op">)</span>, scale <span class="op">=</span> <span class="va">y.max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Chromosome 19"</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>, x <span class="op">=</span> <span class="st">"Copy Number"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">chr19.data.lines</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">x</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">y</span>, color <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">cn</span><span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.5</span>, inherit.aes <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.56</span>, <span class="fl">2.81</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey75"</span>, <span class="st">"lightgreen"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"True Positive"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Copy Number"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figure/chr%2019%20plot-1.png" width="100%" height="60%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lower.p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">1.56</span>, <span class="fl">2.000435</span>, <span class="fl">0.6301878</span>, lower.tail <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">upper.p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fl">2.81</span>, <span class="fl">2.000435</span>, <span class="fl">0.6301878</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">lower.p</span> <span class="op">+</span> <span class="va">upper.p</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.6582322</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sessioninfo</span><span class="fu">::</span><span class="fu"><a href="https://r-lib.github.io/sessioninfo/reference/session_info.html" class="external-link">session_info</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;  setting  value</span></span>
<span><span class="co">#&gt;  version  R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">#&gt;  os       macOS Ventura 13.5</span></span>
<span><span class="co">#&gt;  system   x86_64, darwin20</span></span>
<span><span class="co">#&gt;  ui       RStudio</span></span>
<span><span class="co">#&gt;  language (EN)</span></span>
<span><span class="co">#&gt;  collate  en_US.UTF-8</span></span>
<span><span class="co">#&gt;  ctype    en_US.UTF-8</span></span>
<span><span class="co">#&gt;  tz       America/New_York</span></span>
<span><span class="co">#&gt;  date     2023-09-16</span></span>
<span><span class="co">#&gt;  rstudio  2023.06.0+421 Mountain Hydrangea (desktop)</span></span>
<span><span class="co">#&gt;  pandoc   3.1.1 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;  !  package              * version    date (UTC) lib source</span></span>
<span><span class="co">#&gt;     abind                  1.4-5      2016-07-21 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     askpass                1.2.0      2023-09-03 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     Biobase              * 2.60.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     BiocGenerics         * 0.46.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     BiocParallel           1.34.2     2023-05-22 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     Biostrings             2.68.1     2023-05-16 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     bitops                 1.0-7      2021-04-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     brio                   1.1.3      2021-11-30 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     bslib                  0.5.0      2023-06-09 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     cachem                 1.0.8      2023-05-01 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     Cairo                  1.6-0      2022-07-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     callr                  3.7.3      2022-11-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     circlize               0.4.15     2022-05-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     cli                    3.6.1      2023-03-23 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     clue                   0.3-64     2023-01-31 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     cluster                2.1.4      2022-08-22 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">#&gt;     codetools              0.2-19     2023-02-01 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">#&gt;     colorspace             2.1-0      2023-01-23 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     commonmark             1.9.0      2023-03-17 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ComplexHeatmap         2.16.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     cowplot                1.1.1      2020-12-30 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     crayon                 1.5.2      2022-09-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     credentials            1.3.2      2021-11-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     curl                   5.0.2      2023-08-14 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     dbscan                 1.1-11     2022-10-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     DelayedArray           0.26.7     2023-07-28 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     desc                   1.4.2      2022-09-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     devtools             * 2.4.5      2022-10-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     digest                 0.6.33     2023-07-07 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     distributional         0.3.2      2023-03-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     doParallel             1.0.17     2022-02-07 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     downlit                0.4.3      2023-06-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     dplyr                * 1.1.3      2023-09-03 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ellipsis               0.3.2      2021-04-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     evaluate               0.21       2023-05-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     fansi                  1.0.4      2023-01-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     farver                 2.1.1      2022-07-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     fastmap                1.1.1      2023-02-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     fitdistrplus         * 1.1-11     2023-04-25 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     forcats              * 1.0.0      2023-01-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     foreach                1.5.2      2022-02-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     formatR                1.14       2023-01-17 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     fs                     1.6.3      2023-07-20 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     generics               0.1.3      2022-07-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     GenomeInfoDb         * 1.36.2     2023-08-25 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     GenomeInfoDbData       1.2.10     2023-07-09 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     GenomicRanges        * 1.52.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     gert                   1.9.2      2022-12-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     GetoptLong             1.0.5      2020-12-15 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ggdist               * 3.3.0      2023-05-13 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ggplot2              * 3.4.3      2023-08-14 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ggrepel                0.9.3      2023-02-03 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ggridges               0.5.4      2022-09-26 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     gh                     1.4.0      2023-02-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     gitcreds               0.1.2      2022-09-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     GlobalOptions          0.1.2      2020-06-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     glue                   1.6.2      2022-02-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     gtable                 0.3.4      2023-08-21 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     gtools                 3.9.4      2022-11-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     here                   1.0.1      2020-12-13 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     highr                  0.10       2022-12-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     htmltools              0.5.5      2023-03-23 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     htmlwidgets            1.6.2      2023-03-17 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     httpuv                 1.6.11     2023-05-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     httr2                  0.2.3      2023-05-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     IRanges              * 2.34.1     2023-06-22 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     iterators              1.0.14     2022-02-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     janitor                2.2.0      2023-02-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     jquerylib              0.1.4      2021-04-26 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     jsonlite               1.8.7      2023-06-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;  VP karyotapR            * 1.0.1.9000 2023-09-07 [?] CRAN (R 4.3.1) (on disk 1.0.1)</span></span>
<span><span class="co">#&gt;     knitr                  1.43       2023-05-25 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     labeling               0.4.3      2023-08-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     later                  1.3.1      2023-05-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     lattice                0.21-8     2023-04-05 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">#&gt;     lifecycle              1.0.3      2022-10-07 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     lubridate              1.9.2      2023-02-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     magick                 2.7.4      2023-03-09 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     magrittr               2.0.3      2022-03-30 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     MASS                 * 7.3-60     2023-05-04 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">#&gt;     Matrix                 1.6-0      2023-07-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     MatrixGenerics       * 1.12.3     2023-07-31 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     matrixStats          * 1.0.0      2023-06-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     memoise                2.0.1      2021-11-26 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     mime                   0.12       2021-09-28 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     miniUI                 0.1.1.1    2018-05-18 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     munsell                0.5.0      2018-06-12 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     openssl                2.1.0      2023-07-15 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     pillar                 1.9.0      2023-03-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     pkgbuild               1.4.2      2023-06-26 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     pkgconfig              2.0.3      2019-09-22 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     pkgdown                2.0.7      2022-12-14 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     pkgload                1.3.2.1    2023-07-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     png                    0.1-8      2022-11-29 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     prettyunits            1.1.1      2020-01-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     processx               3.8.2      2023-06-30 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     profvis                0.3.8      2023-05-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     promises               1.2.0.1    2021-02-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     ps                     1.7.5      2023-04-18 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     purrr                * 1.0.2      2023-08-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     R6                     2.5.1      2021-08-19 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rappdirs               0.3.3      2021-01-31 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rcmdcheck              1.4.0      2021-09-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     RColorBrewer           1.1-3      2022-04-03 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     Rcpp                   1.0.11     2023-07-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     RCurl                  1.98-1.12  2023-03-27 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     remotes                2.4.2.1    2023-07-18 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     reticulate             1.31       2023-08-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rhdf5                  2.44.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     rhdf5filters           1.12.1     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     Rhdf5lib               1.22.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     rjson                  0.2.21     2022-01-09 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rlang                  1.1.1      2023-04-28 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rmarkdown              2.23       2023-07-01 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     roxygen2               7.2.3      2022-12-08 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rprojroot              2.0.3      2022-04-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     Rsamtools              2.16.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     RSpectra               0.16-1     2022-04-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     rstudioapi             0.15.0     2023-07-07 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     S4Arrays               1.0.6      2023-08-30 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     S4Vectors            * 0.38.1     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     sass                   0.4.7      2023-07-15 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     scales                 1.2.1      2022-08-20 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     sessioninfo            1.2.2      2021-12-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     shape                  1.4.6      2021-05-19 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     shiny                  1.7.4.1    2023-07-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     SingleCellExperiment * 1.22.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     snakecase              0.11.0     2019-05-25 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     stringdist             0.9.10     2022-11-07 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     stringi                1.7.12     2023-01-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     stringr                1.5.0      2022-12-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     SummarizedExperiment * 1.30.2     2023-06-06 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     survival             * 3.5-5      2023-03-12 [1] CRAN (R 4.3.1)</span></span>
<span><span class="co">#&gt;     sys                    3.4.2      2023-05-23 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     testthat               3.1.10     2023-07-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     tibble                 3.2.1      2023-03-20 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     tidyr                  1.3.0      2023-01-24 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     tidyselect             1.2.0      2022-10-10 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     timechange             0.2.0      2023-01-11 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     umap                   0.2.10.0   2023-02-01 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     urlchecker             1.0.1      2021-11-30 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     usethis              * 2.2.2      2023-07-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     utf8                   1.2.3      2023-01-31 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     vctrs                  0.6.3      2023-06-14 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     viridisLite            0.4.2      2023-05-02 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     whisker                0.4.1      2022-12-05 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     withr                  2.5.0      2022-03-03 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     xfun                   0.39       2023-04-20 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     xml2                   1.3.5      2023-07-06 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     xopen                  1.0.0      2018-09-17 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     xtable                 1.8-4      2019-04-21 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     XVector                0.40.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt;     yaml                   2.3.7      2023-01-23 [1] CRAN (R 4.3.0)</span></span>
<span><span class="co">#&gt;     zlibbioc               1.46.0     2023-05-11 [1] Bioconductor</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  [1] /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/library</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  V ── Loaded and on-disk version mismatch.</span></span>
<span><span class="co">#&gt;  P ── Loaded and on-disk path mismatch.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joseph Mays.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
