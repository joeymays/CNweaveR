<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="calcCopyNumber() transforms the normalized count matrix normcounts of a TapestriExperiment object
into copy number values based on a set of reference cell barcodes and given copy number value (e.g. 2 for diploid).
This is practically used to set the median copy number of a usually diploid reference
cell population to a known copy number value, e.g. 2, and then calculate the copy number for all the
cells relative to that reference population. This occurs individually for each probe,
such that the result is one copy number value per cell barcode per probe (cell-probe unit).
control.copy.number is a data.frame lookup table used to indicate the copy number value and cell barcodes
to use as the reference. A template for control.copy.number can be generated using generateControlCopyNumberTemplate(),
which will have a row for each chromosome arm represented in TapestriExperiment.
The control.copy.number data.frame should include 3 columns named arm, copy.number, and sample.label.
arm is chromosome arm names from chr1p through chrXq, copy.number is the reference copy number value (2 = diploid), and sample.label is the
value corresponding to the colData column given in sample.feature to indicate the set of reference cell barcodes to use to set the copy number.
This is best used in a workflow where the cells are clustered first into their respective samples, and then one cluster is used as the reference population
the other clusters. This also allows for the baseline copy number to be set for each chromosome arm individually in the case where the
reference population is not completely diploid."><title>Calculate relative copy number value for each cell-probe unit using reference sample — calcCopyNumber • CNweaveR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate relative copy number value for each cell-probe unit using reference sample — calcCopyNumber"><meta property="og:description" content="calcCopyNumber() transforms the normalized count matrix normcounts of a TapestriExperiment object
into copy number values based on a set of reference cell barcodes and given copy number value (e.g. 2 for diploid).
This is practically used to set the median copy number of a usually diploid reference
cell population to a known copy number value, e.g. 2, and then calculate the copy number for all the
cells relative to that reference population. This occurs individually for each probe,
such that the result is one copy number value per cell barcode per probe (cell-probe unit).
control.copy.number is a data.frame lookup table used to indicate the copy number value and cell barcodes
to use as the reference. A template for control.copy.number can be generated using generateControlCopyNumberTemplate(),
which will have a row for each chromosome arm represented in TapestriExperiment.
The control.copy.number data.frame should include 3 columns named arm, copy.number, and sample.label.
arm is chromosome arm names from chr1p through chrXq, copy.number is the reference copy number value (2 = diploid), and sample.label is the
value corresponding to the colData column given in sample.feature to indicate the set of reference cell barcodes to use to set the copy number.
This is best used in a workflow where the cells are clustered first into their respective samples, and then one cluster is used as the reference population
the other clusters. This also allows for the baseline copy number to be set for each chromosome arm individually in the case where the
reference population is not completely diploid."><meta property="og:image" content="http://joeymays.xyz/CNweaveR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CNweaveR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/joeymays/CNweaveR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate relative copy number value for each cell-probe unit using reference sample</h1>
      <small class="dont-index">Source: <a href="https://github.com/joeymays/CNweaveR/blob/HEAD/R/copyNumberCalculation.R" class="external-link"><code>R/copyNumberCalculation.R</code></a></small>
      <div class="d-none name"><code>calcCopyNumber.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>calcCopyNumber()</code> transforms the normalized count matrix <code>normcounts</code> of a <code>TapestriExperiment</code> object
into copy number values based on a set of reference cell barcodes and given copy number value (e.g. 2 for diploid).
This is practically used to set the median copy number of a usually diploid reference
cell population to a known copy number value, e.g. 2, and then calculate the copy number for all the
cells relative to that reference population. This occurs individually for each probe,
such that the result is one copy number value per cell barcode per probe (cell-probe unit).
<code>control.copy.number</code> is a <code>data.frame</code> lookup table used to indicate the copy number value and cell barcodes
to use as the reference. A template for <code>control.copy.number</code> can be generated using <code>generateControlCopyNumberTemplate()</code>,
which will have a row for each chromosome arm represented in <code>TapestriExperiment</code>.</p>
<p>The <code>control.copy.number</code> data.frame should include 3 columns named <code>arm</code>, <code>copy.number</code>, and <code>sample.label</code>.
<code>arm</code> is chromosome arm names from chr1p through chrXq, <code>copy.number</code> is the reference copy number value (2 = diploid), and <code>sample.label</code> is the
value corresponding to the <code>colData</code> column given in <code>sample.feature</code> to indicate the set of reference cell barcodes to use to set the copy number.
This is best used in a workflow where the cells are clustered first into their respective samples, and then one cluster is used as the reference population
the other clusters. This also allows for the baseline copy number to be set for each chromosome arm individually in the case where the
reference population is not completely diploid.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calcCopyNumber</span><span class="op">(</span></span>
<span>  <span class="va">TapestriExperiment</span>,</span>
<span>  <span class="va">control.copy.number</span>,</span>
<span>  sample.feature <span class="op">=</span> <span class="st">"cluster"</span>,</span>
<span>  remove.bad.probes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">generateControlCopyNumberTemplate</span><span class="op">(</span></span>
<span>  <span class="va">TapestriExperiment</span>,</span>
<span>  copy.number <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  sample.feature.label <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>TapestriExperiment</dt>
<dd><p><code>TapestriExperiment</code> object.</p></dd>


<dt>control.copy.number</dt>
<dd><p><code>data.frame</code> with columns <code>arm</code>, <code>copy.number</code>, and <code>sample.label</code>. See details.</p></dd>


<dt>sample.feature</dt>
<dd><p>Character, <code>colData</code> column to use for subsetting cell.barcodes. Default "cluster".</p></dd>


<dt>remove.bad.probes</dt>
<dd><p>Logical, if <code>TRUE</code>, probes with median normalized counts = 0 are removed from the returned <code>TapestriExperiment</code>. If FALSE (default), probes with median normalized counts = 0 throw error and stop function.</p></dd>


<dt>copy.number</dt>
<dd><p>Numeric, sets all entries of <code>copy.number</code> column in output. Default 2 (diploid).</p></dd>


<dt>sample.feature.label</dt>
<dd><p>Character, sets all entries of <code>sample.label</code> column in output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>TapestriExperiment</code> object with cell-probe copy number values in <code>copyNumber</code> assay slot.</p>


<p><code>data.frame</code> with 3 columns named <code>arm</code>, <code>copy.number</code>, and <code>sample.label</code></p>


    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>generateControlCopyNumberTemplate()</code>: generates a <code>data.frame</code> template for <code>control.copy.number</code> in <code>calcCopyNumber()</code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tap.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="newTapestriExperimentExample.html">newTapestriExperimentExample</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># example TapestriExperiment object</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Moving gRNA probe  to `altExp` slot "grnaCounts".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Moving barcode probe  to `altExp` slot "barcodeCounts".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Moving chrY probe(s) probe_231, probe_232, probe_233, probe_234, probe_235, probe_236, probe_237, probe_238, probe_239, and probe_240 to `altExp` slot "chrYCounts".</span>
<span class="r-in"><span><span class="va">tap.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcNormCounts.html">calcNormCounts</a></span><span class="op">(</span><span class="va">tap.object</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">control.copy.number</span> <span class="op">&lt;-</span> <span class="fu">generateControlCopyNumberTemplate</span><span class="op">(</span><span class="va">tap.object</span>,</span></span>
<span class="r-in"><span>  copy.number <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  sample.feature.label <span class="op">=</span> <span class="st">"cellline1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tap.object</span> <span class="op">&lt;-</span> <span class="fu">calcCopyNumber</span><span class="op">(</span><span class="va">tap.object</span>,</span></span>
<span class="r-in"><span>  <span class="va">control.copy.number</span>,</span></span>
<span class="r-in"><span>  sample.feature <span class="op">=</span> <span class="st">"test.cluster"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tap.object</span> <span class="op">&lt;-</span> <span class="fu"><a href="newTapestriExperimentExample.html">newTapestriExperimentExample</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># example TapestriExperiment object</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Moving gRNA probe  to `altExp` slot "grnaCounts".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Moving barcode probe  to `altExp` slot "barcodeCounts".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Moving chrY probe(s) probe_231, probe_232, probe_233, probe_234, probe_235, probe_236, probe_237, probe_238, probe_239, and probe_240 to `altExp` slot "chrYCounts".</span>
<span class="r-in"><span><span class="va">control.copy.number</span> <span class="op">&lt;-</span> <span class="fu">generateControlCopyNumberTemplate</span><span class="op">(</span><span class="va">tap.object</span>,</span></span>
<span class="r-in"><span>  copy.number <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  sample.feature.label <span class="op">=</span> <span class="st">"cellline1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Joseph Mays.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

